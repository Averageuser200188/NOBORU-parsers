MangaKakalot=Parser:new("MangaKakalot","https://mangakakalot.com","ENG","MANGAKAKALOT",3)local a={["https://manganelo.tv"]={"a%-h",'class="container%-chapter%-reader">(.-)$',"manga"},["https://mangakakalot.com"]={"row",'class="container%-chapter%-reader">(.-)$',"read"},["https://readmanganato.com"]={"a%-h",'class="container%-chapter%-reader">(.-)$',"manga"}}local function b(c)return c:gsub("&#([^;]-);",function(d)local e=tonumber("0"..d)or tonumber(d)return e and u8c(e)or"&#"..d..";"end):gsub("&(.-);",function(d)return HTML_entities and HTML_entities[d]and u8c(HTML_entities[d])or"&"..d..";"end)end;local function f(g)local h={}Threads.insertTask(h,{Type="StringRequest",Link=g,Table=h,Index="string"})while Threads.check(h)do coroutine.yield(false)end;return h.string or""end;function MangaKakalot:getManga(g,i,j)local k=f(g..i)for l,m,n in k:gmatch('class="list%-truyen%-item%-wrap".-href="(%S-)".-src="(%S-)".-title="[^>]-">([^<]-)<')do local o=CreateManga(b(n),l:match("manga%-(.-)$"),m:gsub("%%","%%%%"),self.ID,l)if o then o.Data.Source=l:match("(https://%S-)/")j[#j+1]=o;coroutine.yield(false)else o=CreateManga(b(n),l:match("read%-(.-)$"),m:gsub("%%","%%%%"),self.ID,l)if o then o.Data.Source=l:match("(https://%S-)/")j[#j+1]=o;coroutine.yield(false)end end end;local p=k:match("Last%((.-)%)")or k:match("LAST%((.-)%)")or k:match("LAST %((.-)%)")or k:match("Last %((.-)%)")j.NoPages=p==nil or p==i end;function MangaKakalot:getPopularManga(i,j)self:getManga(self.Link.."/manga_list?type=topview&category=all&state=all&page=",i,j)end;function MangaKakalot:getLatestManga(i,j)self:getManga(self.Link.."/manga_list?type=latest&category=all&state=all&page=",i,j)end;function MangaKakalot:searchManga(q,i,j)local k=f(self.Link.."/search/story/"..q.."?page="..i)for l,m,n in k:gmatch('class="story_item".-href="(%S-)".-src="(%S-)".-href="[^>]-">([^<]-)<')do local o=CreateManga(b(n),l:match("manga%-(.-)$"),m:gsub("%%","%%%%"),self.ID,l)if o then o.Data.Source=l:match("(https://%S-)/")j[#j+1]=o else o=CreateManga(b(n),l:match("read%-(.-)$"),m:gsub("%%","%%%%"),self.ID,l)if o then o.Data.Source=l:match("(https://%S-)/")j[#j+1]=o;coroutine.yield(false)end end;coroutine.yield(false)end;local p=k:match("Last%((.-)%)")or k:match("LAST%((.-)%)")or k:match("LAST %((.-)%)")or k:match("Last %((.-)%)")j.NoPages=p==nil or p==i end;function MangaKakalot:getChapters(o,j)local k=f(o.Data.Source.."/"..a[o.Data.Source][3].."-"..o.Link)local r={}for l,n in k:gmatch('class="'..a[o.Data.Source][1]..'">.-href="(%S-)" title=".-">([^<]-)<')do r[#r+1]={Name=n,Link=l:match(".+/(.-)$"),Pages={},Manga=o}o.Data.RealLink=l:match(".+/([^/]-)/[^/]-$")if o.Data.Source=="https://mangakakalot.com"then o.Data.RealLink="chapter/"..o.Data.RealLink else o.Data.RealLink=o.Data.RealLink end end;for s=#r,1,-1 do j[#j+1]=r[s]end end;function MangaKakalot:prepareChapter(t,j)local k=f(t.Manga.Data.Source.."/"..t.Manga.Data.RealLink.."/"..t.Link):match(a[t.Manga.Data.Source][2])or""for l in k:gmatch('img src="(%S-)" alt')do j[#j+1]={Link=l:gsub("%%","%%%%"),Header1="referer: "..t.Manga.Data.Source.."/"..t.Manga.Data.RealLink.."/"..t.Link}end end;function MangaKakalot:loadChapterPage(g,j)j.Link=g end;MangaNelo=MangaKakalot:new("MangaNelo","https://manganelo.tv","ENG","MANGANELO",3)function MangaNelo:getManga(g,i,j)local k=f(g..i)for l,m,n in k:gmatch('class="content%-genres%-item".-href="(%S-)".-src="(%S-)".-title="[^>]-">([^<]-)<')do local o=CreateManga(b(n),l:match("manga/(.-)$"),self.Link..m:gsub("%%","%%%%"),self.ID,self.Link.."/manga/"..l)if o then o.Data.Source=l:match("(https://%S-)/")or self.Link;j[#j+1]=o;coroutine.yield(false)end end;local p=k:match("Last%((.-)%)")or k:match("LAST%((.-)%)")or k:match("LAST %((.-)%)")or k:match("Last %((.-)%)")j.NoPages=p==nil or p==i end;function MangaNelo:getPopularManga(i,j)self:getManga(self.Link.."/genre?type=topview&category=all&state=all&page=",i,j)end;function MangaNelo:getLatestManga(i,j)self:getManga(self.Link.."/genre?type=latest&category=all&state=all&page=",i,j)end;function MangaNelo:searchManga(q,i,j)local k=f(self.Link.."/search/"..q.."?page="..i)for l,m,n in k:gmatch('class="search%-story%-item".-href="(%S-)".-src="(%S-)".-title="[^>]-">([^<]-)<')do local o=CreateManga(b(n),l:match("manga/(.-)$"),self.Link..m:gsub("%%","%%%%"),self.ID,l)if o then o.Data.Source=l:match("(https://%S-)/")or self.Link;j[#j+1]=o end;coroutine.yield(false)end;local p=k:match("Last%((.-)%)")or k:match("LAST%((.-)%)")or k:match("LAST %((.-)%)")or k:match("Last %((.-)%)")j.NoPages=p==nil or p==i end;function MangaNelo:getChapters(o,j)local k=f(o.Data.Source.."/manga/"..o.Link)local r={}for l,n in k:gmatch('class="'..a[o.Data.Source][1]..'">.-href="(%S-)" title=".-">([^<]-)<')do r[#r+1]={Name=n,Link=l:match(".+/(.-)$"),Pages={},Manga=o}o.Data.RealLink=l:match(".+/([^/]-)/[^/]-$")if o.Data.Source=="https://mangakakalot.com"then o.Data.RealLink="chapter/"..o.Data.RealLink else o.Data.RealLink=o.Data.RealLink end end;for s=#r,1,-1 do j[#j+1]=r[s]end end;function MangaNelo:prepareChapter(t,j)local k;if t.Manga.Data.Source=="https://manganelo.tv"then k=f(t.Manga.Data.Source.."/chapter/"..t.Manga.Link.."/"..t.Link):match(a[t.Manga.Data.Source][2])or""for l in k:gmatch('data%-src="(%S-)" alt')do j[#j+1]={Link=l:gsub("%%","%%%%"),Header1="referer: "..t.Manga.Data.Source.."/chapter/"..t.Manga.Link.."/"..t.Link}end else k=f(t.Manga.Data.Source.."/"..t.Manga.Data.RealLink.."/"..t.Link):match(a[t.Manga.Data.Source][2])or""for l in k:gmatch('img src="(%S-)" alt')do j[#j+1]={Link=l:gsub("%%","%%%%"),Header1="referer: "..t.Manga.Data.Source.."/"..t.Manga.Data.RealLink.."/"..t.Link}end end end