MangaDoor=Parser:new("MangaDoor","http://mangadoor.com","ESP","MANGADOORESP",1)MangaDoor.Tags={"Acción","Aventura","Comedia","Drama","Ecchi","Fantasía","Gender Bender","Harem","Histórico","Horror","Josei","Artes Marciales","Maduro","Mecha","Misterio","One Shot","Psicológico","Romance","Escolar","Ciencia Ficción","Seinen","Shoujo","Shoujo Ai","Shounen","Shounen Ai","Recuentos de la vida","Deportes","Supernatural","Tragedia","Yaoi","Yuri","Demonios","Juegos","Policial","Militar","Thriller","Autos","Música","Vampiros","Magia","Samurai","Boys love","Hentai"}MangaDoor.TagValues={["Acción"]=1,["Aventura"]=2,["Comedia"]=3,["Drama"]=5,["Ecchi"]=6,["Fantasía"]=7,["Gender Bender"]=8,["Harem"]=9,["Histórico"]=10,["Horror"]=11,["Josei"]=12,["Artes Marciales"]=13,["Maduro"]=14,["Mecha"]=15,["Misterio"]=16,["One Shot"]=17,["Psicológico"]=18,["Romance"]=19,["Escolar"]=20,["Ciencia Ficción"]=21,["Seinen"]=22,["Shoujo"]=23,["Shoujo Ai"]=24,["Shounen"]=25,["Shounen Ai"]=26,["Recuentos de la vida"]=27,["Deportes"]=28,["Supernatural"]=29,["Tragedia"]=30,["Yaoi"]=31,["Yuri"]=32,["Demonios"]=33,["Juegos"]=34,["Policial"]=35,["Militar"]=36,["Thriller"]=37,["Autos"]=38,["Música"]=39,["Vampiros"]=40,["Magia"]=41,["Samurai"]=42,["Boys love"]=43,["Hentai"]=44}MangaDoor.Letters={"#","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"}local function a(b)return b:gsub("&#([^;]-);",function(c)local d=tonumber("0"..c)or tonumber(c)return d and u8c(d)or"&#"..c..";"end):gsub("&(.-);",function(c)return HTML_entities and HTML_entities[c]and u8c(HTML_entities[c])or"&"..c..";"end)end;local function e(b)return b:gsub("\\u(....)",function(c)return u8c(tonumber("0x"..c))end)end;local function f(g)local h={}Threads.insertTask(h,{Type="StringRequest",Link=g,Table=h,Index="text"})while Threads.check(h)do coroutine.yield(false)end;return h.text or""end;function MangaDoor:getManga(g,i)local j=f(g)i.NoPages=true;for k,l,m in j:gmatch('<a href="[^"]-/manga/([^"]-)"[^>]->[^>]-src=\'([^\']-)\' alt=\'([^\']-)\'>[^<]-</a>')do i[#i+1]=CreateManga(a(m),k,l,self.ID,self.Link.."/manga/"..k,self.Link.."/manga/"..k)i.NoPages=false;coroutine.yield(false)end end;function MangaDoor:getPopularManga(n,i)self:getManga(self.Link.."/filterList?sortBy=views&asc=false&page="..n,i)end;function MangaDoor:getAZManga(n,i)self:getManga(self.Link.."/filterList?sortBy=name&asc=true&page="..n,i)end;function MangaDoor:getLetterManga(n,i,o)self:getManga(self.Link.."/filterList?alpha="..o:gsub("#","Other").."&sortBy=name&asc=true&page="..n,i)end;function MangaDoor:getTagManga(n,i,p)self:getManga(self.Link.."/filterList?alpha=&cat="..(self.TagValues[p]or"0").."&sortBy=name&asc=true&page="..n,i)end;function MangaDoor:searchManga(q,n,i)local j=f(self.Link.."/search?query="..q)i.NoPages=true;for r,s in j:gmatch('{"value":"(.-)","data":"(.-)"}')do i[#i+1]=CreateManga(e(r),s,self.Link.."/uploads/manga/"..s.."/cover/cover_250x350.jpg",self.ID,self.Link.."/manga/"..s,self.Link.."/manga/"..s)coroutine.yield(false)end end;function MangaDoor:getChapters(t,i)local j=f(self.Link.."/manga/"..t.Link)local u={}for k,m,v in j:gmatch('chapter%-title%-rtl">[^<]-<a href="[^"]-/manga/([^"]-)">([^<]-)</a>(.-)</h5>')do v=v:match("<em>([^<]-)</em>")u[#u+1]={Name=a(m..(v and": "..v or"")),Link=k,Pages={},Manga=t}end;for w=#u,1,-1 do i[#i+1]=u[w]end end;function MangaDoor:prepareChapter(x,i)local j=f(self.Link.."/manga/"..x.Link)for k in j:gmatch('img%-responsive"[^>]-data%-src=\'//([^\']-)\'')do i[#i+1]=k end end;function MangaDoor:loadChapterPage(g,i)i.Link=g end