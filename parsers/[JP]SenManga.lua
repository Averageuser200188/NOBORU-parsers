SenManga=Parser:new("SenManga","https://raw.senmanga.com","JAP","SENGMANGAJAP",3)SenManga.Filters={{Name="Status",Type="radio",Tags={"All","Ongoing","Completed"},Default="All"},{Name="Type",Type="radio",Tags={"All","Manga","Manhwa","Manhua","Novel"},Default="All"},{Name="Order by",Type="radio",Tags={"A-Z","Z-A","Latest Update","Latest Added","Popular"}},{Name="Genre",Type="check",Tags={"Action","Adult","Adventure","Comedy","Cooking","Drama","Ecchi","Fantasy","Gender Bender","Harem","Historical","Horror","Josei","Light Novel","Magazine","Martial Arts","Mature","Music","Mystery","Psychological","Romance","School Life","Sci-Fi","Seinen","Shoujo","Shoujo Ai","Shounen","Shounen Ai","Slice of Life","Smut","Sports","Supernatural","Tragedy","Webtoons","Yaoi","Yuri"}}}SenManga.Orders={["A-Z"]="titleasc",["Z-A"]="titlereverse",["Latest Update"]="update",["Latest Added"]="latest",["Popular"]="popular"}local function a(b)return b:gsub("&#([^;]-);",function(c)local d=tonumber("0"..c)or tonumber(c)return d and u8c(d)or"&#"..c..";"end):gsub("&(.-);",function(c)return HTML_entities and HTML_entities[c]and u8c(HTML_entities[c])or"&"..c..";"end)end;local function e(f)local g={}Threads.insertTask(g,{Type="StringRequest",Link=f,Table=g,Index="text"})while Threads.check(g)do coroutine.yield(false)end;return g.text or""end;function SenManga:getManga(f,h,i,j)local k=e(f)local l=j and"series"or"border%-light"h.NoPages=true;for m,n,o in k:gmatch('class="item">.-href="[^"]-/([^/"]-)">.-src="([^"]-)".-series%-title">(.-)</div>')do h[#h+1]=CreateManga(a(o),m,n:gsub("%%","%%%%"),self.ID,self.Link.."/"..m)coroutine.yield(false)h.NoPages=false end end;function SenManga:getPopularManga(i,h)self:getManga(self.Link.."/directory/popular?page="..i,h,i)end;function SenManga:getLatestManga(i,h)self:getManga(self.Link.."/directory/last_update?page="..i,h,i)end;function SenManga:searchManga(j,i,h,p)local q=""local r=""local s=""local t=""if p then s=self.Orders[p["Order by"]]=="All"and""or self.Orders[p["Order by"]]for u,v in ipairs(p["Genre"])do q=q.."&genre%%5B%%5D="..v:gsub(" ","+")end;r=p["Status"]=="All"and""or p["Status"]t=p["Type"]=="All"and""or p["Type"]end;self:getManga(self.Link.."/search?s="..j.."&author=&artist="..q.."&status="..r.."&released=&type="..t.."&page="..i.."&order="..s,h,i,true)end;function SenManga:getChapters(w,h)local k=e(self.Link.."/"..w.Link)local x=(k:match('<div class="summary">(.-)</div>')or""):gsub("<br>","\n"):gsub("<.->",""):gsub("\n+","\n"):gsub("^%s+",""):gsub("%s+$","")h.Description=a(x)local y={}for m,o in k:gmatch('<li class="">.-href="[^"]-/([^/"]-)" class="series">%s*(.-)%s*</a>')do y[#y+1]={Name=a(o),Link=m,Pages={},Manga=w}end;for z=#y,1,-1 do h[#h+1]=y[z]end end;function SenManga:prepareChapter(A,h)local k=e(self.Link.."/"..A.Manga.Link.."/"..A.Link)for z=1,tonumber(k:match("</select> of (%d*)")or 0)do h[#h+1]=self.Link.."/viewer/"..A.Manga.Link.."/"..A.Link.."/"..z end end;function SenManga:loadChapterPage(f,h)h.Link=f end