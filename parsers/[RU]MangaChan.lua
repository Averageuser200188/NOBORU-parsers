MangaChan=Parser:new("Манга-Тян!","https://manga-chan.me","RUS","MANGACHANRU",1)local function a(b)if u8c then return b:gsub("&#([^;]-);",function(c)local d=tonumber("0"..c)or tonumber(c)return d and u8c(d)or"&#"..c..";"end):gsub("&([^;]-);",function(c)return HTML_entities and HTML_entities[c]and u8c(HTML_entities[c])or"&"..c..";"end)else return b end end;local function e(f)local g={}Threads.insertTask(g,{Type="StringRequest",Link=f,Table=g,Index="string"})while Threads.check(g)do coroutine.yield(false)end;return g.string or""end;function MangaChan:getManga(f,h)local i=e(f)h.NoPages=true;for j,k,l in i:gmatch('content_row" title=".-href="/manga/([^"]-)%.html"><img src="([^"]-)".-manga_row1.-title_link">(.-)</a>')do h[#h+1]=CreateManga(a(l),j,k:gsub("%%","%%%%"),self.ID,self.Link.."/manga/"..j..".html",self.Link.."/manga/"..j..".html")h.NoPages=false;coroutine.yield(false)end end;function MangaChan:getPopularManga(m,h)self:getManga(self.Link.."/mostfavorites?offset="..(m-1)*20,h)end;function MangaChan:getLatestManga(m,h)self:getManga(self.Link.."/manga/new?offset="..(m-1)*20,h)end;function MangaChan:searchManga(n,m,h)local i=e(self.Link.."/index.php?do=search&subaction=search&search_start=1&full_search=0&result_from="..1+(m-1)*40 .."&result_num=40&story="..n.."&need_sort_date=false")h.NoPages=true;for k,j,l in i:gmatch('content_row" title=".-<img src="([^"]-)".-href="[^"]*/manga/([^"]-)%.html[^>]->(.-)</a>')do h[#h+1]=CreateManga(a(l),j,k:gsub("%%","%%%%"),self.ID,self.Link.."/manga/"..j..".html",self.Link.."/manga/"..j..".html")h.NoPages=false;coroutine.yield(false)end end;function MangaChan:getChapters(o,h)local i=e(self.Link.."/manga/"..o.Link..".html")local p={}for j,l in i:gmatch("href='/online/([^']-).html' title='[^']-'>(.-)</span>")do p[#p+1]={Name=a(l),Link=j,Pages={},Manga=o}end;for q=#p,1,-1 do h[#h+1]=p[q]end end;function MangaChan:prepareChapter(r,h)local i=e(self.Link.."/online/"..r.Link..".html"):match('"fullimg"%s*:%s*%[(.-)%]')or""for f in i:gmatch('"([^"]-)"')do h[#h+1]=f:gsub("\\/","/"):gsub("%%","%%%%")end end;function MangaChan:loadChapterPage(f,h)h.Link=f end;YaoiChan=MangaChan:new("Яой-Тян!","https://yaoi-chan.me","RUS","YAOICHANRU",1)YaoiChan.NSFW=true;HentaiChan=MangaChan:new("Хентай-Тян!","https://hentai-chan.pro","RUS","HENTAICHANRU",1)HentaiChan.NSFW=true;local s="http://exhentai-dono.me"function HentaiChan:getManga(f,h)local i=e(f)h.NoPages=true;for k,j,l in i:gmatch('content_row" title=".-src="([^"]-)".-href="[^"]*/manga/([^"]-)%.html[^>]->(.-)<')do h[#h+1]=CreateManga(a(l),j,k:gsub("%%","%%%%"):gsub("manganew_thumbs_blur","manganew_thumbs"),self.ID,self.Link.."/manga/"..j..".html",self.Link.."/manga/"..j..".html")h.NoPages=false;coroutine.yield(false)end end;function HentaiChan:getPopularManga(m,h)self:getManga(self.Link.."/manga/new&n=favdesc?offset="..(m-1)*20,h)end;function HentaiChan:getLatestManga(m,h)self:getManga(self.Link.."/manga/new?offset="..(m-1)*20,h)end;function HentaiChan:searchManga(n,m,h)self:getManga(self.Link.."/?do=search&subaction=search&story="..n.."&search_start="..1+(m-1)*40 .."&result_num=20",h)end;function HentaiChan:getChapters(o,h)local t={Name=a(o.Name),Link=o.Link,Pages={},Manga=o}h[#h+1]=t end;function HentaiChan:prepareChapter(r,h)local i=e(s.."/online/"..r.Link..".html?development_access=true"):match('"fullimg"%s*:%s*%[(.-)%]')or""for f in i:gmatch("'([^']-)'")do h[#h+1]=f:gsub("\\/","/"):gsub("%%","%%%%")end end;function HentaiChan:loadChapterPage(f,h)h.Link=f end