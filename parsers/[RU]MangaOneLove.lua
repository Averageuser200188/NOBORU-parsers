MangaOneLove=Parser:new("MangaOneLove","https://mangaonelove.ru","RUS","MANGAONELOVERU",3)local function a(b)local c={}Threads.insertTask(c,{Type="StringRequest",Link=b,Table=c,Index="text"})while Threads.check(c)do coroutine.yield(false)end;return c.text or""end;local function d(e)return e:gsub("&#([^;]-);",function(f)local g=tonumber("0"..f)or tonumber(f)return g and u8c(g)or"&#"..f..";"end):gsub("&(.-);",function(f)return HTML_entities and HTML_entities[f]and u8c(HTML_entities[f])or"&"..f..";"end)end;function MangaOneLove:getManga(b,h)local i=a(b)h.NoPages=true;for j,k,l in i:gmatch('manga%-item%-.-href="[^"]-/manga/(.-)/" title="(.-)".-data%-src="(.-)"')do h[#h+1]=CreateManga(d(k),j,l,self.ID,self.Link.."/manga/"..j)h.NoPages=false;coroutine.yield(false)end end;function MangaOneLove:getPopularManga(m,h)self:getManga(self.Link.."/manga/page/"..m.."/?m_orderby=rating",h)end;function MangaOneLove:getAZManga(m,h)self:getManga(self.Link.."/manga/page/"..m.."/?m_orderby=alphabet",h)end;function MangaOneLove:getLatestManga(m,h)self:getManga(self.Link.."/manga/page/"..m.."/?m_orderby=latest",h)end;function MangaOneLove:searchManga(n,m,h)local i=a(self.Link.."/page/"..m.."/?s="..n.."&post_type=wp-manga")h.NoPages=true;for j,k,l in i:gmatch('item__content".-href="[^"]-/manga/(.-)/" title="(.-)".-data%-src="(.-)"')do h[#h+1]=CreateManga(d(k),j,l,self.ID,self.Link.."/manga/"..j)h.NoPages=false;coroutine.yield(false)end end;function MangaOneLove:getChapters(o,h)local i=a(self.Link.."/manga/"..o.Link)local p=(i:match('class="summary__content.-p>(.-)</p>')or""):gsub("<.->",""):gsub("\n+","\n"):gsub("^%s+",""):gsub("%s+$","")local q=i:match('"manga_id":"(%d*)"')local r=a({Link="https://mangaonelove.ru/wp-admin/admin-ajax.php",HttpMethod=POST_METHOD,PostData="action=manga_get_chapters&manga="..q})h.Description=d(p)local s={}local t=false;for u,v in r:gmatch('>([^<]-)</a>%s*<ul class="sub%-chap list%-chap"(.-)</ul>')do t=true;for j,k in v:gmatch('wp%-manga%-chapter%s*">[^<]-<a href="[^"]+/([^"]-)/">%s*([^<]-)%s*</a>')do s[#s+1]={Name=d(u.." - "..k),Link=j,Pages={},Manga=o}end end;if not t then for j,k in r:gmatch('wp%-manga%-chapter%s*">[^<]-<a href="[^"]+/([^"]-)/">%s*([^<]-)%s*</a>')do s[#s+1]={Name=d(k),Link=j,Pages={},Manga=o}end end;for w=1,#s do h[#h+1]=s[w]end end;function MangaOneLove:prepareChapter(x,h)local i=a(self.Link.."/manga/"..x.Manga.Link.."/"..x.Link)i=i:match("chapter_preloaded_images = %[(.-)%]")for j in i:gmatch('"(.-)"')do h[#h+1]=j:gsub("\\/","/")end end;function MangaOneLove:loadChapterPage(b,h)h.Link=b end